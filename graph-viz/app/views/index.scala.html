@()


@defining(play.core.PlayVersion.current) { version =>

<html>

<title>Reply Tweets Deck.GL</title>
<meta name='viewport' />

<style type="text/css">
#container {
  width: 100%;
  height: 100%;
  }
#search{
left:500px;
top:0px;
position:absolute;
}
</style>

<body>
<div id="map" style="width:100vw; height: 100vh"></div>
<div id = "search">
    <p id="content">Reply Tweets Dataset</p>
    <input type="text" class="div" id="query"
           placeholder="Search number of nodes, range from 1-10000, e.g.500. The default value is 5.">
    <button onclick="drawGraph()">submit</button>
</div>
</body>



<script src="/assets/javascripts/deckgl.min.js"></script>
<script src='/assets/javascripts/mapbox-gl.min.js'></script>
<link href='/assets/stylesheets/mapbox-gl.css' rel='stylesheet' />
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiamVyZW15bGkiLCJhIjoiY2lrZ2U4MWI4MDA4bHVjajc1am1weTM2aSJ9.JHiBmawEKGsn3jiRK_d0Gw';
const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/light-v9',
      center: [-96.35,39.5],
      zoom: 3.7
    });
;
function drawGraph(){
  if(map.getLayer('arc')!=undefined){
     map.removeLayer('arc')
  }

  query = document.getElementById("query").value;

  var request = new XMLHttpRequest();
  request.open('GET', 'http://localhost:9000/replies?query='+query, false);//for async
  request.send(null);
  if (request.status === 200) {
     var data = JSON.parse(request.responseText);
     const myArcLayer = new MapboxLayer({
        id: 'arc',
		type: ArcLayer,
        pickable: true,
        data: data,
        getSourcePosition: d => d.source,
        getTargetPosition: d => d.target,
        getSourceColor: [12, 44, 132],
        getTargetColor: [177, 0, 38],
        gettrokeWidth: 3
      });

    map.addLayer(myArcLayer);
}
}
</script>

</html>

}